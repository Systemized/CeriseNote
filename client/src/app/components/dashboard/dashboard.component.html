<section class="content-container">
    <div class="content left">
        <h3 class="title">Notes</h3>
        <button (click)="createNote()">+ &nbsp;Create Note</button>
        @for (note of notes; track note._id) {
        <div class="Card noteC" title="{{ note.title }}" (click)="openModal(note)">
            <div>{{ note.title }}</div>
            <div class="note-cont">{{ note.content.length < 25 ? note.content : note.content.slice(0,25) + '...' }}</div>
        </div>
        }
    </div>

    <div class="content right">
        <h3 class="title">Files</h3>
        <!-- button trigger hidden file input -->
        <button (click)="triggerFileUpload()" class="file-upload-btn">+ &nbsp;Upload File</button>
        <!-- Add a hidden file input -->
        <input type="file" #fileInput hidden (change)="onFileSelected($event)" />

        @for (file of files; track file.key) {
        <div class="Card fileC" title="{{ file.fileName }}" (click)="openFile(file.key)">
            <span class="file-name">
                <a href="https://pub-049ce40230004d74b09a4b62f26971f0.r2.dev/{{ file.key }}"
                    target="_blank">{{ file.fileName.length < 20 ? file.fileName : file.fileName.slice(0, 20) + '...' }}</a>
                <button class="delete-file-btn" (click)="deleteFile(file.key)">Delete</button>
            </span>
        </div>
        }
    </div>
</section>

@if (selectedNote) {
<div class="modal-container">
    <div class="modal">
        <p>Title</p>
        <textarea [(ngModel)]="this.selectedNote.title" id="title-text"></textarea>
        <p>Content</p>
        <textarea [(ngModel)]="this.selectedNote.content" id="content-text"></textarea>
        <div class="modal-btns">
            @if (this.selectedNote._id) {
            <button (click)="deleteNote(this.selectedNote._id)">Delete</button>
            <div>
                <button (click)="closeModal()">Cancel</button>
                <button id="save-btn" (click)="updateNote(this.selectedNote._id)">Save</button>
            </div>
            } @else {
            <button (click)="closeModal()">Cancel</button>
            <div>
                <button id="save-btn" (click)="postNote()">Save</button>
            </div>
            }
        </div>
    </div>
</div>
}